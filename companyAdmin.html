<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=640,target-densitydpi=device-dpi,user-scalable=no" />
    <title>展商管理人员</title>   
    <script src="jweixin-1.3.2.js"></script>
    <script src="jquery-1.11.2.min.js"></script>
     <script>
        //解析url参数 start
        function getParamer(paramer){
            var url=window.location.href.split("?")[1];            /*获取url里"?"后面的值*/
            if(url.indexOf("&")>0){                                      /*判断是否是一个参数还是多个参数*/
                urlParamArry=url.split("&");                            /*分开每个参数，并放到数组里*/
                for(var i=0; i<urlParamArry.length; i++){
                    var paramerName=urlParamArry[i].split("=");   /*把每个参数名和值分开，并放到数组里*/
                    if(paramer==paramerName[0]){                     /*匹配输入的参数和数组循环出来的参数是否一样*/
                        // $(".pagetitle").html("改变信息....")
                        return paramerName[1];                           /*返回想要的参数值*/
                    }
                }
            }else{                                                              /*判断只有个参数*/
                var paramerValue=url.split("=")[1];
                return paramerValue;
            }
        }

        $(document).ready(function(){
            globalDataLastId    = ''
            globalAcDataLastId  = ''
            getBusinessCardList()
        })



        function getBusinessCardList(){
            //切换tab
            changeTab('mp')

            //获取名片列表
            var companyId   = getParamer('companyId')
            var userId      = getParamer('userId')
            var lastId      = globalDataLastId

            var header      = {
                "userId": getParamer('userId'),
                "sessionId": getParamer('sessionId')
            };
            $.ajax({
                type: "GET",
                data: {
                    companyId:companyId,
                    userId:userId,
                    lastId:lastId,
                    pageSize:10
                },
                contentType: "application/x-www-form-urlencoded",
                url: "http://www.view-ol.com/viewol_web/ucard/ucardList",
                beforeSend: function (xhr) {
                    if(header){
                        for(name in header){
                            xhr.setRequestHeader(name, header[name]);
                        }
                    }
                },
                success: function (data) {
                    var re = JSON.parse(data)
                    console.log("===========获取名片列表===========")
                    console.log("userId:"+userId)
                    console.log("lastId:"+lastId)
                    console.log("companyId:"+companyId)
                    console.log(re)
                    console.log("===========end===========")
                    if(re.result!=null){
                        var rs   = re.result
                        var html = "";
                        for(var i=0 ; i<rs.length ; i++){
                            // html += '<div class="item"><div class="acname">'+rs[i].title+'</div><div class="time">'+rs[i].createTime +'</div><div class="button '+th+'">'+status+'</div></div>'
                            html +- '<div class="item"><img src="images/mp.jpg" alt="" class="icon"><div class="name">'+rs[i].getfUserName  +'<text class="tt">职位：'+rs[i].getfPosition   +'</text></div><div class="tel">电话：'+rs[i].getfPhone +'</div><div class="company">缺少客户公司名</div></div>'
                            console.log(html)
                            // globalDataLastId = 
                            $(".mpItemBox").append(html)
                        }
                    }else{
                        var html = '<div class="none"><img src="images/nodata.jpg" alt="" class="none"><div>还没有人与您交换名片哦</div></div>'
                        $(".mpItemBox").html(html)
                    }
                },
            });
        }

        function getActivitiesList(){
            //切换tab
            changeTab('ac')

            //获取活动列表
            var companyId   = getParamer('companyId')
            var userId      = getParamer('userId')
            var lastSeq     = globalAcDataLastId
            var time        = ''
            var date        = ''

            var header      = {
                "userId": getParamer('userId'),
                "sessionId": getParamer('sessionId')
            };
            $.ajax({
                type: "GET",
                data: {
                    time:time,
                    date:date,
                    type:1,
                    keyword:'',
                    lastSeq:lastSeq,
                    companyId:companyId,
                    num:50,

                },
                contentType: "application/x-www-form-urlencoded",
                url: "http://www.view-ol.com/viewol_web/schedule/listSchedule",
                beforeSend: function (xhr) {
                    if(header){
                        for(name in header){
                            xhr.setRequestHeader(name, header[name]);
                        }
                    }
                },
                success: function (data) {
                    var re = JSON.parse(data)
                    console.log("===========获取名片列表===========")
                    console.log("time:"+time)
                    console.log("date:"+date)
                    console.log("type:"+1)
                    console.log("keyword:")
                    console.log("lastSeq:"+lastSeq)
                    console.log("companyId:"+companyId)
                    console.log(re)
                    console.log("===========end===========")
                    if(re.result!=null){
                        // alert(re.message)
                        var rs = re.result
                        var html = "";
                        for(var i=0 ; i<rs.length ; i++){
                            console.log(rs[i].status)
                            switch (rs[i].status)
                            {
                                case -1:
                                    var status = "被打回" 
                                    var th     = "th"
                                    break;
                                case 1:
                                    var status = "通过" 
                                    var th     = ""
                                    break;
                                case 0:
                                    var status = "待审核" 
                                    var th     = ""
                                    break;
                                default:
                                    var status = "解析错误" 
                                    var th     = ""
                                    break;
                          }
                            html += '<div class="item"><div class="acname">'+rs[i].title+'</div><div class="time">'+rs[i].createTime +'</div><div class="button '+th+'">'+status+'</div></div>'
                            console.log(html)
                            globalAcDataLastId
                        }

                        $(".acItemBox .acitembox2").html(html)
                        //跳转到后续页面
                    }else{
                        var html = '<div class="none"><img src="images/nodata.jpg" alt="" class="none"><div>您还没有申请活动哦</div></div>'
                        $(".acItemBox .acitembox2").html(html)
                    }
                },
            });
        }

        function changeTab(name){
            if( name =="mp"){
                $(".tabbox .mp").addClass("on")
                $(".tabbox .ac").removeClass("on")
                $(".mpItemBox").css({"display":"block"})
                $(".acItemBox").css({"display":"none"})
            }else{
                $(".tabbox .ac").addClass("on")
                $(".tabbox .mp").removeClass("on")
                $(".mpItemBox").css({"display":"none"})
                $(".acItemBox").css({"display":"block"})
            }
        }
    </script>
</head>

<body>
<script>

</script>

<style type="text/css">
    /*body{background:#ff5a5e;}*/
    html,body,ul,li,p{padding:0;margin:0;}
    .outbox{width:640px; background:#fff;}
    .mainbox{padding:24px;font-size:22px;}

    .outbox .header{height: 180px;padding:24px;position: relative;}
    .outbox .header .avata{width:96px;height:96px;border-radius:100px; border:3px #e0e0e0 solid;}
    .outbox .header .userinfo{position: absolute;width:430px;height:244px;top:30px;left:140px;}
    .outbox .header .userinfo .name{font-size:28px;font-weight:bold;padding-bottom:24px; }
    .outbox .header .userinfo .other{font-size:24px;display: flex;  align-items:center; /* 垂直居中 */}
    .outbox .header .userinfo .other text{display: block;width: 100px;}
    .outbox .header .userinfo .other input{width: 210px;height: 40px;line-height:40px;border: 1px #3d3ab2 dotted;}
    .outbox .header .userinfo>div{padding-bottom:10px; }
    .outbox .header .editbutton{width:122px;height: 46px;border:1px #c8c3c1 solid;color:#3d3ab2;text-align: center;line-height:46px;position: absolute; right: 26px;display: flex;  justify-content:center; /* 水平居中 */  align-items:center; /* 垂直居中 */background:#fff;}
    .outbox .header .editbutton img{width: 22px;height:22px; margin-right:10px; }

    .outbox .tabbox{height:70px;width:100%;display: flex;}
    .outbox .tabbox>div{flex: 1;border-bottom:1px #e4e4e4 solid;height:69px;text-align: center; line-height: 70px; font-size: 22px;font-weight: bold;cursor:pointer;}
    .outbox .tabbox>div.on{border-bottom:3px #3d3ab2 solid;height:67px;color: #3d3ab2;}


    .mpItemBox{}
    .mpItemBox .item{height:110px; margin:0 24px; border-bottom:2px   #3d3ab2 dotted;position: relative;font-size:24px;padding:15px 0;}
    .mpItemBox .item img{position: absolute;top:26px;left:5px;}
    .mpItemBox .item .name{height: 50px;padding-left:50px;font-weight:bold;display: flex; align-items:center; /* 垂直居中 */}
    .mpItemBox .item .name text{margin-left:20px; font-weight:500;color:#76747b;}
    .mpItemBox .item .tel{position: absolute; top: 76px; text-align: left; width: 100%;color:#76747b;}
    .mpItemBox .item .company{position: absolute; top: 76px; text-align: right; width: 100%;color:#76747b;}
    .none{text-align: center; padding-top: 80px;font-size:22px;}

    .acItemBox{display: none;}
    .acItemBox .item{height:82px; margin:0 24px; border-bottom:2px   #3d3ab2 dotted;position: relative;font-size:24px;padding:26px 0;}
    .acItemBox .acname{font-size:26px;font-weight:bold;padding-bottom:20px; }
    .acItemBox .time{color:#797575;font-size:22px;}
    .acItemBox .button{width:122px;height: 46px;border:1px #3d3ab2 dotted;color:#3d3ab2;text-align: center;line-height:46px;position: absolute; right: 26px;font-size:22px;top:44px;}
    .acItemBox .button.th{width:122px;height: 46px;border:1px #ff6a6a dotted;color:#ff6a6a;text-align: center;line-height:46px;position: absolute; right: 26px;}
    .acItemBox .applybutton{height:100px;color: #3d3ab2;text-align: center;font-size:24px;line-height:100px;font-weight: bold;position: fixed;bottom:0;background:#fff;border-top:1px #eee solid;width:100%;}
    .acItemBox .applybutton a:link , .acItemBox .applybutton a:active , .acItemBox .applybutton a:visited{display: block;width:100%;height:100%;text-decoration: none;cursor: pointer;color: #3d3ab2;}
    
</style>

<div class="outbox">
    <div class="header">
        <div class="showbox">
            <img src="http://www.ghost64.com/qqtupian/zixunImg/local/2018/01/17/15161775048939.jpg" alt="" class="avata">
            <div class="userinfo">
                <div class="name">浙江大华浙江大华浙江大华</div>
                <div class="other"><text>管理员：</text></div>
                <div class="tt other"><text>职位：</text></div>
                <div class="tel other"><text>电话：</text>1861682883</div>
            </div>

            <div class="editbutton">
                <img src="images/edit.jpg" alt="" class="icon">
                修改
            </div>
        </div>
<!-- 
        <div class="editbox">
            <img src="http://www.ghost64.com/qqtupian/zixunImg/local/2018/01/17/15161775048939.jpg" alt="" class="avata">
            <div class="userinfo">
                <div class="name">浙江大华浙江大华浙江大华</div>
                <div class="other">
                    <text>管理员：</text>
                    <input type="text" value="" maxlength="10"></div>
                <div class="tt other"><text>职位：</text><input type="text" value="" maxlength="20"></div>
                <div class="tel other"><text>电话：</text><input type="text" value="" maxlength="11"></div>
            </div>

            <div class="editbutton">
                <img src="images/edit.jpg" alt="" class="icon">
                修改
            </div>
        </div> -->
    </div>
    
    <div class="tabbox">
        <div class="mp on" onclick="getBusinessCardList()">名片</div>
        <div class="ac" onclick="getActivitiesList()">活动</div>
    </div>

    <div class="mpItemBox">
<!--         <div class="item">
            <img src="images/mp.jpg" alt="" class="icon">
            <div class="name">小月月<text class="tt">职位：</text></div>

            <div class="tel">电话：1861687333</div>
            <div class="company">大话科技</div>
        </div> -->

    </div>
    <div class="acItemBox">
        <div class="acitembox2">
        <!-- <div class="item">
            <div class="acname">大话控制</div>
            <div class="time">2018.10.24</div>
            <div class="button th">通过/被打回</div>
        </div>
        <div class="item">
            <div class="acname">大话控制</div>
            <div class="time">2018.10.24</div>
            <div class="button th">通过/被打回</div>
        </div> -->
        </div>

        <div class="applybutton">
            <a href="activitiesApply.html?companyId=5&userId=4&companyName=优恒科技&email=1@q.com">
                申请活动
            </a>
        </div>
    </div>
</div>

</body>
</html>